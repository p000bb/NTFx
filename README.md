# NTFx - 芯片引脚可视化配置系统

> 一款专业的 Web 端芯片引脚功能配置与可视化工具，帮助工程师快速进行 MCU/芯片引脚分配、冲突检测和配置管理。

## 📋 目录

- [项目简介](#项目简介)
- [核心功能](#核心功能)
- [技术栈](#技术栈)
- [快速开始](#快速开始)
- [使用指南](#使用指南)
  - [项目管理](#1-项目管理)
  - [芯片数据管理](#2-芯片数据管理)
  - [引脚配置预览](#3-引脚配置预览)
  - [工具栏功能](#4-工具栏功能)
- [系统特性](#系统特性)
- [多语言支持](#多语言支持)
- [常见问题](#常见问题)

---

## 🎯 项目简介

NTFx 是一个基于 Web 的芯片引脚可视化配置系统，主要用于：

- **在线可视化配置**：通过直观的可视化界面进行芯片引脚功能分配
- **项目管理**：支持多项目管理，便于维护不同项目的芯片数据
- **冲突检测**：实时检测引脚功能冲突，提供智能提示
- **数据导出**：支持导出 Excel、SVG、PNG、PDF 等多种格式

系统采用 **IndexedDB** 进行本地数据存储，无需服务器即可使用，数据安全可靠。

---

## ✨ 核心功能

### 🔹 项目管理
- 创建、编辑、删除项目
- 项目数据本地持久化存储
- 支持项目备注信息

### 🔹 芯片数据管理
- Excel 模板下载
- Excel 数据上传与解析
- 芯片数据名称修改
- 芯片数据删除

### 🔹 可视化引脚配置
- 真实芯片封装可视化展示
- 点击引脚选择功能
- 实时冲突检测与高亮提示
- 引脚搜索与筛选
- 多芯片切换查看

### 🔹 工具栏功能
- 撤销/重做操作
- 画布缩放与拖拽
- 芯片与引脚样式配置
- 全屏/取消全屏
- 配置导出（Excel/SVG/PNG/PDF）
- 配置重置
- 统计信息与冲突详情

### 🔹 多语言支持
- 中文（简体）
- English

---

## 🛠 技术栈

- **前端框架**：Vue 3 + TypeScript
- **构建工具**：Vite
- **UI 框架**：Tailwind CSS
- **状态管理**：Pinia
- **数据存储**：IndexedDB (Dexie)
- **路由**：Vue Router
- **图标库**：Lucide Vue Next
- **Excel 处理**：ExcelJS
- **PDF 导出**：jsPDF
- **工具库**：VueUse、Lodash-es

---

## 🚀 快速开始

### 环境要求

- Node.js >= 16.0.0
- pnpm >= 7.0.0

### 安装依赖

```bash
pnpm install
```

### 启动开发服务器

```bash
pnpm dev
```

### 构建生产版本

```bash
pnpm build
```

---

## 📖 使用指南

### 1. 项目管理

#### 创建新项目

1. 在首页点击 **"新增项目"** 按钮
2. 输入项目名称（必填）和备注信息（可选）
3. 点击 **"确认"** 保存项目

#### 编辑项目

1. 在项目列表中点击项目卡片上的 **编辑按钮**
2. 修改项目名称或备注信息
3. 点击 **"确认"** 保存修改

#### 删除项目

1. 在项目列表中点击项目卡片上的 **删除按钮**
2. 确认删除操作（将同时删除该项目下的所有芯片数据）

#### 进入项目预览

点击项目卡片进入该项目的引脚配置预览页面。

---

### 2. 芯片数据管理

#### 下载 Excel 模板

1. 在项目编辑对话框中点击 **"下载模板"** 按钮
2. 下载标准 Excel 模板文件
3. 按照模板格式填写芯片引脚数据

**Excel 模板字段说明：**
- `Pin name`: 引脚名称（如 PA0, PB1）
- `Type`: 引脚类型（I/O、I、O 等）
- `Io`: IO 类型
- `Fail`: Fail-safe 配置
- `Digital`: 数字功能列表（用逗号分隔）
- `Analog`: 模拟功能列表（用逗号分隔）

#### 上传芯片数据

1. 在项目编辑对话框中点击 **"选择文件"** 或拖拽 Excel 文件到上传区域
2. 系统自动解析 Excel 文件中的芯片数据
3. 解析成功后，芯片列表会显示在上传区域下方

#### 修改芯片名称

1. 在芯片列表中找到需要修改的芯片
2. 直接在上方的输入框中修改芯片名称
3. 保存项目后，芯片名称会自动更新

#### 删除芯片数据

1. 在芯片列表中点击对应芯片右侧的 **删除按钮**
2. 确认删除操作

---

### 3. 引脚配置预览

#### 搜索引脚

在预览页面顶部的搜索框中输入关键字，系统会在以下位置搜索：

- **引脚名称**（如 PA0, PB1）
- **引脚数字功能**（Digital 功能列表）
- **引脚模拟功能**（Analog 功能列表）

**搜索特性：**
- 输入至少 2 个字符后开始搜索
- 匹配的引脚会高亮闪烁 5 秒
- 支持实时搜索

#### 切换芯片

在搜索框右侧的下拉框中选择项目下的其他芯片，即可切换查看不同芯片的引脚配置。

#### 选择引脚功能

1. **点击引脚**：点击芯片图中的任意引脚
2. **选择功能**：在弹出的下拉菜单中选择要分配的功能
   - **Common**：通用功能（Reset、Input、Output、EXTI）
   - **Digital**：数字功能列表
   - **Analog**：模拟功能列表

3. **确认选择**：点击功能选项完成分配

#### 冲突检测

系统会实时检测引脚功能冲突：

- **冲突提示**：如果选择的引脚功能与其他引脚冲突，下拉菜单中会以 **黄色背景** 高亮显示冲突选项
- **冲突确认**：点击冲突选项时，系统会弹出确认对话框，显示冲突的引脚信息
- **冲突高亮**：冲突的引脚会在芯片图上以 **红色闪烁** 提示
- **冲突详情**：可在右下角工具栏的 **"信息"** 面板中查看所有冲突详情

#### 清除引脚功能

在引脚功能下拉菜单中选择 **"Reset"** 选项，即可清除该引脚的功能分配。

---

### 4. 工具栏功能

预览页面右下角提供以下工具：

#### 🔄 撤销/重做

- **撤销**：撤销上一步操作（快捷键：Ctrl+Z）
- **重做**：重做已撤销的操作（快捷键：Ctrl+Y）
- 支持多级撤销/重做

#### 🔍 缩放与拖拽

- **缩放**：使用鼠标滚轮缩放画布
- **拖拽**：按住鼠标左键拖拽画布移动
- 支持鼠标手势进行缩放操作

#### ⚙️ 设置

点击设置按钮打开配置面板：

**芯片配置：**
- **芯片比例**：调整芯片大小（0.5x - 2.0x）
- **字体大小**：调整引脚名称字体大小
- **起始位置**：选择引脚编号起始位置（左/上/右/下）

**引脚配置：**
- **数字功能颜色**：自定义数字功能引脚的颜色
- **模拟功能颜色**：自定义模拟功能引脚的颜色
- **通用功能颜色**：自定义通用功能引脚的颜色
- 可根据个人喜好进行颜色定制

#### 🖥️ 全屏/取消全屏

- **全屏**：点击全屏按钮进入全屏模式
- **取消全屏**：在全屏模式下点击取消全屏按钮退出

#### 💾 下载

点击下载按钮打开下载面板，支持导出以下格式：

**Excel 导出：**
- 导出当前项目的所有芯片配置
- 包含引脚信息、功能选择、冲突状态等
- 支持多芯片数据合并导出

**SVG 导出：**
- 导出矢量图形格式
- 可无损放大，适合打印和文档使用

**PNG 导出：**
- 导出位图格式
- 适合截图和快速分享

**PDF 导出：**
- 导出 PDF 文档
- 适合正式文档归档

#### 🔄 复位

点击复位按钮，系统会提示确认，确认后：
- 清除所有引脚功能分配
- 恢复默认配置
- **注意**：此操作不可撤销，请谨慎使用

#### 📊 信息面板

点击信息按钮打开信息面板，包含两个标签页：

**统计信息：**
- 总引脚数
- 已使用引脚数
- 未使用引脚数
- 冲突引脚数
- 各类型引脚统计（数字/模拟/通用）

**冲突详情：**
- 显示所有引脚冲突情况
- 列出冲突的引脚对
- 提供冲突原因说明
- 支持快速定位冲突引脚

---

## 🎨 系统特性

### 数据存储

- **IndexedDB 本地存储**：所有数据存储在浏览器本地，无需服务器
- **实时保存**：配置更改后自动保存，无需手动保存
- **数据安全**：数据存储在用户本地，隐私安全有保障

### 冲突检测算法

系统采用智能冲突检测算法：

- **EXTI 冲突检测**：同一 EXTI 线不能分配给多个引脚
- **功能冲突检测**：同一功能不能分配给多个引脚
- **实时检测**：每次配置后立即检测冲突
- **视觉反馈**：冲突引脚以红色闪烁提示

### 可视化特性

- **真实封装展示**：芯片引脚布局与实际封装高度吻合
- **颜色区分**：不同类型的功能使用不同颜色标注
- **交互友好**：鼠标悬浮显示引脚详细信息
- **响应式设计**：支持不同屏幕尺寸

---

## 🌍 多语言支持

系统支持中英双语切换：

1. 在预览页面右上角点击 **语言选择** 按钮
2. 选择 **中文** 或 **English**
3. 界面语言立即切换

当前支持的语言：
- 🇨🇳 中文（简体）
- 🇺🇸 English

---

## ❓ 常见问题

### Q: 数据保存在哪里？

A: 所有数据保存在浏览器的 IndexedDB 中，不会上传到服务器。清除浏览器数据会导致数据丢失，请注意备份。

### Q: 如何备份数据？

A: 可以通过导出 Excel 文件来备份项目配置，需要时再重新导入。

### Q: 为什么搜索不到引脚？

A: 请确保：
1. 输入至少 2 个字符
2. 搜索关键字匹配引脚名称或功能名称
3. 检查是否选择了正确的芯片

### Q: 如何清除所有配置？

A: 点击右下角工具栏的 **复位** 按钮，确认后即可清除所有引脚功能分配。

### Q: 冲突检测不准确怎么办？

A: 系统使用标准的冲突检测规则。如果发现误报，请检查：
1. 引脚的 Digital/Analog 功能列表是否正确
2. 是否启用了冲突提示设置

### Q: 支持哪些浏览器？

A: 建议使用以下浏览器：
- Chrome/Edge (推荐)
- Firefox
- Safari

需要支持 IndexedDB 和现代 JavaScript 特性。

---

## 📝 更新日志

### v1.0.0
- ✨ 初始版本发布
- ✅ 项目管理功能
- ✅ 芯片数据上传与解析
- ✅ 可视化引脚配置
- ✅ 冲突检测功能
- ✅ 多格式导出功能
- ✅ 中英双语支持

---

## 📄 许可证

MIT License

---

## 👥 贡献

欢迎提交 Issue 和 Pull Request！

---

**如有问题或建议，请通过 Issue 反馈。** 🎉

